 TestPostHttp;cfg;webservice;meter;counter;mtr
 :If 0<⎕NC 'GITHUB_ACTIONS'
    :AndIf 0<GITHUB_ACTIONS
        Skip'PostHttp not available on Github'
 :EndIf
⍝ ##.Reset
⍝ webservice←⎕NEW #.Notela.Jarvis(8092 ## 'JSON')
⍝ webservice.Start
⍝ cfg←##.Notela.NewConfiguration'Tests' '1.0.0'
⍝ cfg.ExportInterval←0
⍝ cfg.BatchSize←3
⍝ cfg.OtelHttpUrlMetrics←'http://localhost:8092/send'
⍝ ##.Notela.Start cfg
⍝ meter←##.Notela.GetMeter'TestMeter' '0.1.0'
⍝ counter←meter.CreateCounter'aplerrors'
⍝ counter.Record 15 'exception.type' 11
⍝ counter.Record 2 'exception.type' 11
⍝ counter.Record 3 'exception.type' 11
⍝
⍝ mtr←##.GetTrace 0.1
⍝ Assert∧/'exception'∊mtr
⍝ webservice.Stop
⍝
